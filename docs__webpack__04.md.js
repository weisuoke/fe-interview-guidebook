(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[131],{ol0B:function(e,n,t){"use strict";t.r(n);var l=t("q1tI"),o=t.n(l),a=t("dEAq"),r=t("H1Ra"),i=o.a.memo((e=>{e.demos;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"markdown"},o.a.createElement("h1",{id:"webpack\u7684\u6784\u5efa\u6d41\u7a0b\u662f\u4ec0\u4e48"},o.a.createElement(a["AnchorLink"],{to:"#webpack\u7684\u6784\u5efa\u6d41\u7a0b\u662f\u4ec0\u4e48","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"webpack\u7684\u6784\u5efa\u6d41\u7a0b\u662f\u4ec0\u4e48?"),o.a.createElement("h2",{id:"\u6982\u8ff0"},o.a.createElement(a["AnchorLink"],{to:"#\u6982\u8ff0","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"\u6982\u8ff0"),o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement("p",null,"\u521d\u59cb\u5316\u53c2\u6570\uff1a\u4ece\u914d\u7f6e\u6587\u4ef6\u548cShell\u8bed\u53e5\u4e2d\u8bfb\u53d6\u4e0e\u5408\u5e76\u53c2\u6570\uff0c\u5f97\u51fa\u6700\u7ec8\u7684\u53c2\u6570\uff1b")),o.a.createElement("li",null,o.a.createElement("p",null,"\u5f00\u59cb\u7f16\u8bd1\uff1a\u7528\u4e0a\u4e00\u6b65\u5f97\u5230\u7684\u53c2\u6570\u521d\u59cb\u5316Compiler\u5bf9\u8c61\uff0c\u52a0\u8f7d\u6240\u6709\u914d\u7f6e\u7684\u63d2\u4ef6\uff0c\u6267\u884c\u5bf9\u8c61\u7684run\u65b9\u6cd5\u5f00\u59cb\u6267\u884c\u7f16\u8bd1\uff1b \u786e\u5b9a\u5165\u53e3\uff1a\u6839\u636e\u914d\u7f6e\u4e2d\u7684entry\u627e\u51fa\u6240\u6709\u7684\u5165\u53e3\u6587\u4ef6")),o.a.createElement("li",null,o.a.createElement("p",null,"\u7f16\u8bd1\u6a21\u5757\uff1a\u4ece\u5165\u53e3\u6587\u4ef6\u51fa\u53d1\uff0c\u8c03\u7528\u6240\u6709\u914d\u7f6e\u7684Loader\u5bf9\u6a21\u5757\u8fdb\u884c\u7f16\u8bd1\uff0c\u518d\u627e\u51fa\u8be5\u6a21\u5757\u4f9d\u8d56\u7684\u6a21\u5757\uff0c\u518d\u9012\u5f52\u672c\u6b65\u9aa4\u76f4\u5230\u6240\u6709\u5165\u53e3\u4f9d\u8d56\u7684\u6587\u4ef6\u90fd\u7ecf\u8fc7\u4e86\u672c\u6b65\u9aa4\u7684\u5904\u7406\uff1b")),o.a.createElement("li",null,o.a.createElement("p",null,"\u5b8c\u6210\u6a21\u5757\u7f16\u8bd1\uff1a\u5728\u7ecf\u8fc7\u7b2c 4 \u6b65\u4f7f\u7528Loader\u7ffb\u8bd1\u5b8c\u6240\u6709\u6a21\u5757\u540e\uff0c\u5f97\u5230\u4e86\u6bcf\u4e2a\u6a21\u5757\u88ab\u7ffb\u8bd1\u540e\u7684\u6700\u7ec8\u5185\u5bb9\u4ee5\u53ca\u5b83\u4eec\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb \u8f93\u51fa\u8d44\u6e90\uff1a\u6839\u636e\u5165\u53e3\u548c\u6a21\u5757\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u7ec4\u88c5\u6210\u4e00\u4e2a\u4e2a\u5305\u542b\u591a\u4e2a\u6a21\u5757\u7684 Chunk\uff0c\u518d\u628a\u6bcf\u4e2aChunk\u8f6c\u6362\u6210\u4e00\u4e2a\u5355\u72ec\u7684\u6587\u4ef6\u52a0\u5165\u5230\u8f93\u51fa\u5217\u8868\uff0c\u8fd9\u6b65\u662f\u53ef\u4ee5\u4fee\u6539\u8f93\u51fa\u5185\u5bb9\u7684\u6700\u540e\u673a\u4f1a")),o.a.createElement("li",null,o.a.createElement("p",null,"\u8f93\u51fa\u5b8c\u6210\uff1a\u5728\u786e\u5b9a\u597d\u8f93\u51fa\u5185\u5bb9\u540e\uff0c\u6839\u636e\u914d\u7f6e\u786e\u5b9a\u8f93\u51fa\u7684\u8def\u5f84\u548c\u6587\u4ef6\u540d\uff0c\u628a\u6587\u4ef6\u5185\u5bb9\u5199\u5165\u5230\u6587\u4ef6\u7cfb\u7edf"),o.a.createElement("blockquote",null,o.a.createElement("p",null,"\u5728\u4ee5\u4e0a\u8fc7\u7a0b\u4e2d\uff0cWebpack \u4f1a\u5728\u7279\u5b9a\u7684\u65f6\u95f4\u70b9\u5e7f\u64ad\u51fa\u7279\u5b9a\u7684\u4e8b\u4ef6\uff0c\u63d2\u4ef6\u5728\u76d1\u542c\u5230\u611f\u5174\u8da3\u7684\u4e8b\u4ef6\u540e\u4f1a\u6267\u884c\u7279\u5b9a\u7684\u903b\u8f91\uff0c\u5e76\u4e14\u63d2\u4ef6\u53ef\u4ee5\u8c03\u7528 Webpack \u63d0\u4f9b\u7684 API \u6539\u53d8 Webpack \u7684\u8fd0\u884c\u7ed3\u679c")))),o.a.createElement("p",null,o.a.createElement("img",{src:"https://wsk-mweb.oss-cn-hangzhou.aliyuncs.com/ipic/2020-10-08-041425.png",alt:"webpackflow2020"})),o.a.createElement("h2",{id:"1-webpackconfigjs"},o.a.createElement(a["AnchorLink"],{to:"#1-webpackconfigjs","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"1. webpack.config.js"),o.a.createElement(r["a"],{code:'const path = require("path");\nconst RunPlugin = require("./plugins/RunPlugin");\nconst DonePlugin = require("./plugins/DonePlugin");\nmodule.exports = {\n  context: process.cwd(),\n  mode: "development",\n  devtool: false,\n  entry: "./src/app.js",\n  output: {\n    path: path.resolve(__dirname, "dist"),\n    filename: "main.js",\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.jsx?$/,\n        use: {\n          loader: "babel-loader",\n          options: {\n            presets: ["@babel/preset-env"],\n          },\n        },\n        include: path.join(__dirname, "src"),\n        exclude: /node_modules/,\n      },\n    ],\n  },\n  plugins: [new RunPlugin(),new DonePlugin()],\n  devServer: {},\n};',lang:"js"}),o.a.createElement("h2",{id:"2-flowjs"},o.a.createElement(a["AnchorLink"],{to:"#2-flowjs","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"2. flow.js"),o.a.createElement("p",null,"flow.js"),o.a.createElement(r["a"],{code:'let fs = require(\'fs\');\nlet path = require(\'path\');\nconst { SyncHook } = require("tapable");\n\nclass Compiler {\n  constructor(options) {\n    this.options = options;\n    this.hooks = {\n      run: new SyncHook(),\n      done: new SyncHook(),\n    };\n  }\n  run() {\n    this.hooks.run.call();  \n    let modules = [];\n    let chunks = [];\n    let files = [];\n    // \u786e\u5b9a\u5165\u53e3\uff1a\u6839\u636e\u914d\u7f6e\u4e2d\u7684entry\u627e\u51fa\u6240\u6709\u7684\u5165\u53e3\u6587\u4ef6\n    let entry = path.join(this.options.context, this.options.entry);\n    //\u4ece\u5165\u53e3\u6587\u4ef6\u51fa\u53d1\uff0c\u8c03\u7528\u6240\u6709\u914d\u7f6e\u7684Loader\u5bf9\u6a21\u5757\u8fdb\u884c\u7f16\u8bd1\uff0c\n    let entryContent = fs.readFileSync(entry, "utf8");\n    let entrySource = babelLoader(entryContent);\n    let entryModule = { id: entry, source: entrySource };\n    modules.push(entryModule);\n    //\u518d\u627e\u51fa\u8be5\u6a21\u5757\u4f9d\u8d56\u7684\u6a21\u5757\uff0c\u518d\u9012\u5f52\u672c\u6b65\u9aa4\u76f4\u5230\u6240\u6709\u5165\u53e3\u4f9d\u8d56\u7684\u6587\u4ef6\u90fd\u7ecf\u8fc7\u4e86\u672c\u6b65\u9aa4\u7684\u5904\u7406\n    let title = path.join(this.options.context, "./src/title.js");\n    let titleContent = fs.readFileSync(title, "utf8");\n    let titleSource = babelLoader(titleContent);\n    let titleModule = { id: title, source: titleSource };\n    modules.push(titleModule);\n    //\u6839\u636e\u5165\u53e3\u548c\u6a21\u5757\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u7ec4\u88c5\u6210\u4e00\u4e2a\u4e2a\u5305\u542b\u591a\u4e2a\u6a21\u5757\u7684 Chunk\n    let chunk = { name: "main", modules };\n    chunks.push(chunk);\n    //\u518d\u628a\u6bcf\u4e2aChunk\u8f6c\u6362\u6210\u4e00\u4e2a\u5355\u72ec\u7684\u6587\u4ef6\u52a0\u5165\u5230\u8f93\u51fa\u5217\u8868\n    let file = {\n      file: this.options.output.filename,\n      source: `\n        (function (modules) {\n           function __webpack_require__(moduleId) {\n             var module = { exports: {} };\n             modules[moduleId].call(\n             module.exports,\n             module,\n             module.exports,\n             __webpack_require__\n             );\n             return module.exports;\n           }\n           return __webpack_require__("./src/app.js");\n         })(\n        {\n         "./src/app.js": function (module, exports, __webpack_require__) {\n             var title = __webpack_require__("./src/title.js");\n             console.log(title);\n         },\n         "./src/title.js": function (module) {\n             module.exports = "title";\n         },\n        });\n      `,\n    };\n    files.push(file);\n    //\u5728\u786e\u5b9a\u597d\u8f93\u51fa\u5185\u5bb9\u540e\uff0c\u6839\u636e\u914d\u7f6e\u786e\u5b9a\u8f93\u51fa\u7684\u8def\u5f84\u548c\u6587\u4ef6\u540d\uff0c\u628a\u6587\u4ef6\u5185\u5bb9\u5199\u5165\u5230\u6587\u4ef6\u7cfb\u7edf\n    let outputPath = path.join(\n      this.options.output.path,\n      this.options.output.filename\n    );\n    fs.writeFileSync(outputPath, file.source,\'utf8\');\n      this.hooks.done.call();  \n  }\n}\n//1.\u4ece\u914d\u7f6e\u6587\u4ef6\u548cShell\u8bed\u53e5\u4e2d\u8bfb\u53d6\u4e0e\u5408\u5e76\u53c2\u6570\uff0c\u5f97\u51fa\u6700\u7ec8\u7684\u53c2\u6570\nlet options = require(\'./webpack.config\');\n//2.\u7528\u4e0a\u4e00\u6b65\u5f97\u5230\u7684\u53c2\u6570\u521d\u59cb\u5316Compiler\u5bf9\u8c61\nlet compiler = new Compiler(options);\n//3.\u52a0\u8f7d\u6240\u6709\u914d\u7f6e\u7684\u63d2\u4ef6\nif (options.plugins && Array.isArray(options.plugins)) {\n  for (const plugin of options.plugins) {\n   plugin.apply(compiler);\n  }\n}\n//4.\u6267\u884c\u5bf9\u8c61\u7684run\u65b9\u6cd5\u5f00\u59cb\u6267\u884c\u7f16\u8bd1\ncompiler.run();\nfunction babelLoader(source) {\n  return `var sum = function sum(a, b) {\n              return a + b;\n            };`;\n}',lang:"js"}),o.a.createElement("h2",{id:"3-runpluginjs"},o.a.createElement(a["AnchorLink"],{to:"#3-runpluginjs","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"3. RunPlugin.js"),o.a.createElement("p",null,"plugins\\RunPlugin.js"),o.a.createElement(r["a"],{code:'module.exports = class RunPlugin {\n  apply(compiler) {\n    compiler.hooks.run.tap("RunPlugin", () => {\n      console.log("RunPlugin");\n    });\n  }\n}',lang:"js"}),o.a.createElement("h2",{id:"4-donepluginjs"},o.a.createElement(a["AnchorLink"],{to:"#4-donepluginjs","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"4. DonePlugin.js"),o.a.createElement("p",null,"plugins\\DonePlugin.js"),o.a.createElement(r["a"],{code:'module.exports = class DonePlugin {\n  apply(compiler) {\n    compiler.hooks.done.tap("DonePlugin", () => {\n      console.log("DonePlugin");\n    });\n  }\n};',lang:"js"})))}));n["default"]=e=>{var n=o.a.useContext(a["context"]),t=n.demos;return o.a.useEffect((()=>{var n;null!==e&&void 0!==e&&null!==(n=e.location)&&void 0!==n&&n.hash&&a["AnchorLink"].scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),o.a.createElement(i,{demos:t})}}}]);