(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[117],{kgsh:function(e,t,n){"use strict";n.r(t);var a=n("q1tI"),l=n.n(a),r=n("dEAq"),c=n("H1Ra"),o=l.a.memo((e=>{e.demos;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"markdown"},l.a.createElement("h1",{id:"redux-\u5982\u4f55\u4f18\u5316"},l.a.createElement(r["AnchorLink"],{to:"#redux-\u5982\u4f55\u4f18\u5316","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"Redux \u5982\u4f55\u4f18\u5316"),l.a.createElement("p",null,"\u5728\u505a redux \u4f18\u5316\u4e4b\u524d\u6709\u51e0\u4e2a\u6982\u5ff5\u9700\u8981\u4e86\u89e3\u6e05\u695a\u3002"),l.a.createElement("h2",{id:"pure"},l.a.createElement(r["AnchorLink"],{to:"#pure","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"Pure"),l.a.createElement("p",null,"\u65e0\u8bba\u662f\u5728 react \u8fd8\u662f redux \u4e2d\uff0cpure \u90fd\u662f\u975e\u5e38\u91cd\u8981\u7684\u6982\u5ff5"),l.a.createElement("p",null,"\u9996\u5148\u6211\u4eec\u8981\u4ecb\u7ecd\u4ec0\u4e48\u662f Pure function (\u7eaf\u51fd\u6570)"),l.a.createElement("blockquote",null,l.a.createElement("p",null,"\u7eaf\u51fd\u6570\u662f\u8fd9\u6837\u4e00\u79cd\u51fd\u6570\uff0c\u5373\u76f8\u540c\u7684\u8f93\u5165\uff0c\u6c38\u8fdc\u4f1a\u5f97\u5230\u76f8\u540c\u7684\u8f93\u51fa\uff0c\u800c\u4e14\u6ca1\u6709\u4efb\u4f55\u53ef\u89c2\u5bdf\u7684\u526f\u4f5c\u7528")),l.a.createElement("p",null,"\u7b80\u5355\u6765\u8bf4\u7eaf\u51fd\u6570\u7684\u4e24\u4e2a\u7279\u5f81\uff1a"),l.a.createElement("ol",null,l.a.createElement("li",null,"\u5bf9\u4e8e\u76f8\u540c\u7684\u8f93\u5165\u603b\u6709\u76f8\u540c\u7684\u8f93\u51fa"),l.a.createElement("li",null,"\u51fd\u6570\u4e0d\u4f9d\u8d56\u5916\u90e8\u53d8\u91cf\uff0c\u4e5f\u4e0d\u4f1a\u5bf9\u5916\u90e8\u4ea7\u751f\u5f71\u54cd\uff08\u8fd9\u79cd\u5f71\u54cd\u79f0\u4e4b\u4e3a\u201c\u526f\u4f5c\u7528\uff08side effects\uff09\u201d\uff09")),l.a.createElement("h2",{id:"reducer"},l.a.createElement(r["AnchorLink"],{to:"#reducer","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"Reducer"),l.a.createElement("p",null,"redux \u4e2d\u89c4\u5b9a reducer \u5c31\u662f\u7eaf\u51fd\u6570\u3002\u5b83\u63a5\u6536\u524d\u4e00\u4e2a state \u72b6\u6001\u548c action \u4f5c\u4e3a\u53c2\u6570\uff0c\u8fd4\u56de\u4e0b\u4e00\u4e2a\u72b6\u6001\uff1a"),l.a.createElement(c["a"],{code:"(previousState, action) => newState;",lang:"js"}),l.a.createElement("p",null,"\u4fdd\u8bc1 reducer \u7684\u201c\u7eaf\u7cb9\uff08pure\uff09\u201d\u975e\u5e38\u91cd\u8981\uff0c\u4f60\u6c38\u8fdc\u4e0d\u80fd\u5728 reducer \u4e2d\u505a\u4ee5\u4e0b\u4e09\u4ef6\u4e8b\uff1a"),l.a.createElement("ul",null,l.a.createElement("li",null,"\u4fee\u6539\u53c2\u6570"),l.a.createElement("li",null,"\u6267\u884c\u4efb\u4f55\u5177\u6709\u526f\u4f5c\u7528\u7684\u64cd\u4f5c\uff0c\u6bd4\u5982\u8c03\u7528API"),l.a.createElement("li",null,"\u8c03\u7528\u4efb\u4f55\u4e0d\u7eaf\u7cb9\u7684\u51fd\u6570\uff0c\u6bd4\u5982",l.a.createElement("code",null,"Math.random()"),"\u6216\u8005",l.a.createElement("code",null,"Date.now()"))),l.a.createElement("p",null,"\u6240\u4ee5\u4f60\u4f1a\u770b\u5230\u5728 reducer \u91cc\u8fd4\u56de\u72b6\u6001\u662f\u901a\u8fc7 ",l.a.createElement("code",null,"Object.assign(","{","}",", state)"),"\u5b9e\u73b0\u7684\uff08\u6ce8\u610f\u4e0d\u8981\u5199\u6210 Object.assign(state)\u8fd9\u6837\u5c31\u4fee\u6539\u4e86\u539f\u72b6\u6001\uff09\u3002\u800c\u81f3\u4e8e\u8c03\u7528API\u7b49\u5f02\u6b65\u6216\u8005\u5177\u6709\u201c\u526f\u4f5c\u7528\u201d\u7684\u64cd\u4f5c\uff0c\u5219\u53ef\u4ee5\u501f\u52a9\u4e8e redux-thunk \u6216\u8005 redux-saga."),l.a.createElement("h2",{id:"\u6027\u80fd"},l.a.createElement(r["AnchorLink"],{to:"#\u6027\u80fd","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u6027\u80fd"),l.a.createElement("p",null,"\u5728 react-redux \u4e2d\uff0c\u6211\u4eec\u901a\u5e38\u4f1a\u4f7f\u7528 react-redux \u4e2d\u7684 connect \u51fd\u6570\u5c06\u7a0b\u5e8f\u72b6\u6001\u6ce8\u5165\u8fdb\u7ec4\u4ef6\u4e2d\uff0c\u4f8b\u5982\uff1a"),l.a.createElement(c["a"],{code:"import { connect } from 'react-redux';\n\nfunction mapStateToProps(state) {\n  return {\n    todos: state.todos,\n    visibleTodos: getVisibleTodos(state)\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);",lang:"js"}),l.a.createElement("p",null,"\u4ee3\u7801\u4e2d\u7ec4\u4ef6App\u662f\u88abreact-redux\u5c01\u88c5\u7684\u7ec4\u4ef6\uff0creact-redux\u4f1a\u5047\u8bbe App \u662f\u4e00\u4e2a Pure Component\uff0c\u5373\u5bf9\u4e8e\u552f\u4e00\u7684 props \u548c state \u6709\u552f\u4e00\u7684\u6e32\u67d3\u7ed3\u679c\u3002\u6240\u4ee5 react-redux \u9996\u5148\u4f1a\u5bf9\u6839\u72b6\u6001\uff08\u5373\u4e0a\u8ff0\u4ee3\u7801\u4e2d mapStateToProps \u7684\u7b2c\u4e00\u4e2a\u5f62\u53c2 state\uff09\u521b\u5efa\u7d22\u5f15\uff0c\u8fdb\u884c\u6d45\u5bf9\u6bd4\uff0c\u5982\u679c\u5bf9\u6bd4\u7ed3\u679c\u4e00\u81f4\u5219\u4e0d\u5bf9\u7ec4\u4ef6\u8fdb\u884c\u91cd\u65b0\u6e32\u67d3\uff0c\u5426\u5219\u7ee7\u7eed\u8c03\u7528 mapStateToProps \u51fd\u6570\uff1b\u540c\u65f6\u7ee7\u7eed\u5bf9 mapStateToProps \u8fd4\u56de\u7684 props \u5bf9\u8c61\u91cc\u7684\u6bcf\u4e00\u4e2a\u5c5e\u6027\u7684\u503c\uff08\u5373\u4e0a\u8ff0\u4ee3\u7801\u4e2d\u7684 ",l.a.createElement("code",null,"state.todos"),"\u503c\u548c",l.a.createElement("code",null,"getVisibleTodos(state)"),"\u503c, \u800c\u4e0d\u662f\u8fd4\u56de\u7684props \u6574\u4e2a\u5bf9\u8c61\uff09\u521b\u5efa\u7d22\u5f15\u3002\u548c shouldComponentUpdate \u7c7b\u4f3c\uff0c\u53ea\u6709\u5f53\u6d45\u5bf9\u6bd4\u5931\u8d25\uff0c\u5373\u7d22\u5f15\u53d1\u751f\u66f4\u6539\u65f6\u624d\u4f1a\u91cd\u65b0\u5bf9\u5c01\u88c5\u7684\u7ec4\u4ef6\u8fdb\u884c\u6e32\u67d3\u3002"),l.a.createElement("p",null,"\u5176\u6b21\u662f\u5728 combineReducers \u4e2d\u3002"),l.a.createElement("p",null,"\u6211\u4eec\u90fd\u77e5\u9053 Redux Store \u9f13\u52b1\u6211\u4eec\u628a\u72b6\u6001\u5bf9\u8c61\u5212\u5206\u4e3a\u4e0d\u540c\u7684\u788e\u7247\uff08slice\uff09\u6216\u8005\uff08domain\uff0c\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e1a\u52a1\uff09\uff0c\u5e76\u4e14\u4e3a\u8fd9\u4e9b\u4e0d\u540c\u7684\u9886\u57df\u5206\u522b\u7f16\u5199 reducer \u51fd\u6570\u7528\u4e8e\u7ba1\u7406\u4ed6\u4eec\u7684\u72b6\u6001\uff0c\u6700\u540e\u4f7f\u7528\u5b98\u65b9\u63d0\u4f9b\u7684 combineReducer \u51fd\u6570\u5c06\u8fd9\u4e9b\u9886\u57df\u4ee5\u53ca\u4ed6\u4eec\u7684 reducer \u51fd\u6570\u5173\u8054\u8d77\u6765\uff0c\u62fc\u88c5\u6210\u4e00\u4e2a\u6574\u4f53\u7684 state\u3002"),l.a.createElement("p",null,"combineReducers \u4f1a\u904d\u5386\u6bcf\u4e00\u5bf9\u201c\u9886\u57df\u201c\uff08key \u662f\u9886\u57df\u540d\u79f0\u3001value \u662f\u9886\u57df reducer \u51fd\u6570\uff09\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u904d\u5386"),l.a.createElement("ul",null,l.a.createElement("li",null,"\u5b83\u4f1a\u521b\u5efa\u4e00\u4e2a\u961f\u5f53\u524d\u788e\u7247\u6570\u636e\u7684\u7d22\u5f15"),l.a.createElement("li",null,"\u8c03\u7528 reducer \u51fd\u6570\u8ba1\u7b97\u788e\u7247\u6570\u636e\u65b0\u7684\u72b6\u6001\uff0c\u5e76\u4e14\u8fd4\u56de"),l.a.createElement("li",null,"\u4e3a reducer \u51fd\u6570\u8fd4\u56de\u7684\u65b0\u7684\u788e\u7247\u6570\u636e\u521b\u5efa\u65b0\u7684\u5f15\u7528\uff0c\u5c06\u65b0\u7684\u5f15\u7528\u548c\u5f53\u524d\u6570\u636e\u5f15\u7528\u8fdb\u884c\u6d45\u5bf9\u6bd4\uff0c\u5982\u679c\u5bf9\u6bd4\u5931\u8d25\u4e86\uff08\u540c\u65f6\u610f\u5473\u7740\u4e24\u6b21\u5f15\u7528\u4e0d\u4e00\u81f4\uff0c\u610f\u5473\u7740 reducer \u8fd4\u56de\u7684\u662f\u4e00\u4e2a\u65b0\u7684\u5bf9\u8c61\uff09\uff0c\u90a3\u4e48\u5c06\u6807\u8bc6\u4f4d has Changed \u8bbe\u7f6e\u4e3a true")),l.a.createElement("p",null,"\u5728\u7ecf\u8fc7\u8bae\u8bba\uff08\u8fd9\u91cc\u7684\u4e00\u8f6e\u6307\u7684\u662f\u628a\u6bcf\u4e00\u4e2a\u9886\u57df\u90fd\u904d\u5386\u4e86\u4e00\u904d\uff09\uff0c\u904d\u5386\u4e4b\u540e\uff0c",l.a.createElement("code",null,"combineReducer"),"\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a\u65b0\u7684\u72b6\u6001\u5bf9\u8c61\uff0c\u901a\u8fc7",l.a.createElement("code",null,"hasChanged"),"\u6807\u5fd7\u4f4d\u6211\u4eec\u5c31\u80fd\u5224\u65ad\u51fa\u6574\u4f53\u72b6\u6001\u662f\u5426\u53d1\u751f\u4e86\u66f4\u6539\uff0c\u5982\u679c\u4e3atrue\uff0c\u65b0\u7684\u72b6\u6001\u5c31\u4f1a\u88ab\u8fd4\u56de\u7ed9\u4e0b\u6e38\uff0c\u5982\u679c\u662ffalse\uff0c\u65e7\u7684\u72b6\u6001\u5c31\u4f1a\u88ab\u8fd4\u56de\u7ed9\u4e0b\u6e38\u3002\u8fd9\u91cc\u7684\u4e0b\u6e38\u6307\u7684\u662f react-redux \u4ee5\u53ca\u66f4\u4e0b\u6e38\u7684\u754c\u9762\u7ec4\u4ef6\u3002"),l.a.createElement("p",null,"\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86 react-redux \u4f1a\u5bf9\u6839\u72b6\u6001\u8fdb\u884c\u6d45\u5bf9\u6bd4\uff0c\u5982\u679c\u5f15\u7528\u53d1\u751f\u4e86\u6539\u53d8\uff0c\u624d\u91cd\u65b0\u6e32\u67d3\u7ec4\u4ef6\u3002\u6240\u4ee5\u5f53\u72b6\u6001\u9700\u8981\u53d1\u751f\u66f4\u6539\u65f6\uff0c\u52a1\u5fc5\u8ba9\u76f8\u5e94\u7684reducer\u51fd\u6570\u59cb\u7ec8\u8fd4\u56de\u65b0\u7684\u5bf9\u8c61\uff1a"),l.a.createElement(c["a"],{code:"function myCounterReducer(state = { count: 0 }, action) {\n  switch (action.type) {\n    case 'add':\n      return Object.assign({}, state, { count: state.count + 1 });\n    default: \n     \treturn state;\n  }\n}",lang:"js"}),l.a.createElement("h2",{id:"immutable-data-\u548c-immutablejs"},l.a.createElement(r["AnchorLink"],{to:"#immutable-data-\u548c-immutablejs","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"Immutable Data \u548c Immutablejs"),l.a.createElement("p",null,"\u7ed3\u5408\u4ee5\u4e0a\u4e24\u4e2a\u77e5\u8bc6\u70b9\uff0c\u65e0\u8bba\u4ecereducer\u7684\u5b9a\u4e49\u4e0a\uff0c\u8fd8\u662f\u4eceredux\u7684\u5de5\u4f5c\u673a\u5236\u4e0a\uff0c\u6211\u4eec\u90fd\u8d70\u4e0a\u4e86\u540c\u4e00\u6761Object.assign\u7684\u6a21\u5f0f\uff0c\u5373\u4e0d\u4fee\u6539\u539f\u72b6\u6001\uff0c\u53ea\u8fd4\u56de\u65b0\u72b6\u6001\u3002\u53ef\u89c1state\u5929\u751f\u5c31\u662f\u4e0d\u53ef\u88ab\u66f4\u6539\u7684\uff08Immutable\uff09"),l.a.createElement("p",null,"\u4f46\u4f7f\u7528Object.assign\u7684\u65b9\u6cd5\u5374\u4e0d\u80fd\u7b97\u4f18\u96c5\uff0c\u751a\u81f3\u6709hack\u7684\u5acc\u7591\uff0c\u6bd5\u7adfObject.assign\u7684\u672c\u610f\u662f\u7528\u6765\u590d\u5236\u4e00\u4e2a\u5bf9\u8c61\u7684\u5c5e\u6027\u5230\u53e6\u4e00\u4e2a\u5bf9\u8c61\u7684\u3002\u4e8e\u662f\u6211\u4eec\u5728\u8fd9\u91cc\u5f15\u5165\u4e86 Immutablejs\uff0c\u5b83\u4e3a\u6211\u4eec\u5b9e\u73b0\u4e86\u51e0\u7c7b\u201c\u4e0d\u53ef\u66f4\u6539\u201d\u7684\u6570\u636e\u7ed3\u6784\uff1a"),l.a.createElement(c["a"],{code:"import { Map } from 'immutable';\nconst person = Map();\nconst personWithAge = person.set('age', 20);\\\n\nconsole.log(person.toJS());\t// {}\nconsole.log(personWithAge.toJS());\t// { age: 20 }",lang:"js"}),l.a.createElement("p",null,"\u5728Immutablejs\u7684\u6570\u636e\u7ed3\u6784\u4e2d\uff0c\u5f53\u4f60\u60f3\u66f4\u6539\u67d0\u4e2a\u5bf9\u8c61\u5c5e\u6027\u65f6\uff0c\u4f60\u5f97\u5230\u7684\u6c38\u8fdc\u662f\u4e00\u4e2a\u65b0\u7684\u5bf9\u8c61\uff0c\u800c\u539f\u5bf9\u8c61\u6c38\u8fdc\u4e5f\u4e0d\u4f1a\u53d1\u751f\u66f4\u6539\u3002\u8fd9\u4e0e\u6211\u4eec Object.assign \u7684\u4f7f\u7528\u573a\u666f\u662f\u5951\u5408\u7684\u3002\u90a3\u4e48\u5f53\u6211\u4eec\u9700\u8981\u4fee\u6539 state \u800c state \u662f Immutablejs \u6570\u636e\u7ed3\u6784\u65f6\uff0c\u4fee\u6539\u5e76\u4e14\u8fd4\u56de\u5373\u53ef\uff1a"),l.a.createElement(c["a"],{code:"function myCounterReducer(state = { count: 0 }, action) {\n  switch(action.type) {\n    case 'add':\n      return state.set('count', state.get('count') + 1);\n    default:\n      return state;\n  }\n}",lang:"js"}),l.a.createElement("h2",{id:"\u5b9e\u4f8b\u6d4b\u8bd5"},l.a.createElement(r["AnchorLink"],{to:"#\u5b9e\u4f8b\u6d4b\u8bd5","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u5b9e\u4f8b\u6d4b\u8bd5"),l.a.createElement("p",null,"\u5047\u8bbe\u6211\u4eec\u6709\u5341\u4e07\u4e2a todos \u6570\u636e\uff0c\u4f7f\u7528\u51fd\u6570\u751f\u6210\u5341\u4e07\u4e2a todos:"),l.a.createElement(c["a"],{code:"function generateTodos() {\n  let count = 10000;\n  while(count) {\n    todos[count.toString()] = { title: `Task ${count}`, completed: false };\n    count--\n  }\n  return todos;\n}",lang:"js"}),l.a.createElement("p",null,"\u6211\u4eec\u51c6\u5907\u4e00\u4e2aredecer\u7528\u4e8e\u6839\u636eid\u5207\u6362\u5355\u4e2atodo\u7684completed\u72b6\u6001"),l.a.createElement(c["a"],{code:"function toggleTodo(todos, id) {\n  return Object.assign({}, todos, {\n    [id]: Object.assign({}, todos[id], {\n      completed: !todos[id].completed,\n    }),\n  });\n}\n\nconst startTime = performance.now();\nconst nextState = toggleTodo(todos, String(10000 / 2));\nconsole.log(performance.now() - startTime);",lang:"js"}),l.a.createElement("p",null,"\u6253\u5370\u51fa\u6765\u7684\u6267\u884c\u65f6\u95f4\u662f33ms\u5de6\u53f3"),l.a.createElement("p",null,"\u63a5\u4e0b\u6765\u6211\u4eec\u628atoggleTodo\u6362\u6210Immutablejs\u7248\u672c\uff08\u5f53\u7136\u6570\u636e\u4e5f\u8981\u662fImmutablejs\u4e2d\u7684Map\u6570\u636e\u7c7b\u578b\uff0cImmutablejs\u63d0\u4f9b\u4e86\u65b9\u6cd5fromJS\u80fd\u591f\u5f88\u65b9\u4fbf\u7684\u5c06\u539f\u751fJavaScript\u6570\u636e\u7c7b\u578b\u8f6c\u5316\u4e3aImmutablejs\u6570\u636e\u7c7b\u578b\uff09\uff0c\u518d\u8bd5\u8bd5\u770b\uff1a"),l.a.createElement(c["a"],{code:"function toggleTodo(todos, id) {\n  return todos.set(id, !todos.getIn([id, 'completed']))\n}\nconst startTime = performance.now()\nconst nextState = toggleTodo(state, String(10000 / 2));\nconsole.log(performance.now() - startTime);",lang:"js"}),l.a.createElement("p",null,"\u6253\u5370\u51fa\u6765\u7684\u6267\u884c\u65f6\u95f4\u4e0d\u8d85\u8fc7 1ms")))}));t["default"]=e=>{var t=l.a.useContext(r["context"]),n=t.demos;return l.a.useEffect((()=>{var t;null!==e&&void 0!==e&&null!==(t=e.location)&&void 0!==t&&t.hash&&r["AnchorLink"].scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),l.a.createElement(o,{demos:n})}}}]);